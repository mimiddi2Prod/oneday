<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!--适配移动端 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <title>商品列表</title>
    <script type="text/javascript" src="../node_modules/vue/dist/vue.min.js"></script>
    <script type="text/javascript" src="../jquery-3.3.1/jquery-3.3.1.min.js"></script>
    <link rel="stylesheet" type="text/css"
          href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
    <script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../layDate-v5.0.9/laydate/laydate.js"></script> <!--时间控件-->
    <script type="text/javascript" src="../js/utils/apis.js"></script>
    <script type="text/javascript" src="../js/utils/http.js"></script> <!--封装接口请求-->
    <script type="text/javascript" src="../js/utils/formatTime.js"></script> <!--时间格式化-->
    <script type="text/javascript" src='https://unpkg.com/qiniu-js@2.5.3/dist/qiniu.min.js'></script> <!--七牛云图片上传所需-->
    <script type="text/javascript" src="../js/utils/qiniuUpload.js"></script> <!--封装的七牛云图片上传-->
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/menu.css" rel="stylesheet">
    <link href="../css/addGoods.css" rel="stylesheet">
</head>

<body>
<div id="LoadMenu" class="left">
    <load-menu></load-menu>
</div>


<div class="right">
    <div class="jumbotron" id="addGoods">
        <!-- 类目 添加分类 -->
        <div class="title row-center">
            <h4><span v-on:click="window.location.href = 'goods'">商品管理</span><span
                    class="glyphicon glyphicon-menu-right"></span><span>添加商品</span></h4>
        </div>

        <!-- 添加商品信息分栏 -->
        <!-- 基础信息 -->
        <div class="subtitle">
            <div>基础信息</div>

            <div class="sort row-center">
                <div class="index">商品图片</div>
                <div class="item">
                    <div class="row-center">
                        <div class="goods-img">
                            <input id="inputImg1" class="getImg" type="file" accept="image/*"
                                   v-on:change="getImg('inputImg1')" multiple/> <!-- multiple能够选择多张图片 -->
                            <em class="img-r abs">&nbsp;</em>
                            <em class="img-c abs">&nbsp;</em>
                        </div>
                        <div class="imgShow" v-if="img_list.length > 0" v-for="item,index in img_list">
                            <input :id="'replaceImg'+index" class="getImg" type="file" accept="image/*"
                                   v-on:change="replaceImg(index)"/>
                            <img class="imgSrc" :src='item.tempFilePath'>
                            <img class="imgDel" src="/images/del.png" v-on:click="delImg(index)">
                        </div>
                    </div>
                    <div class="text">选择的第一张图将作为商品封面图。</div>
                </div>
            </div>

            <div class="sort row-center">
                <div class="index">商品标题</div>
                <div class="item"><input v-model="goods_title" type="text" class="form-control" name=""/></div>
            </div>

            <div class="sort row-center">
                <div class="index">商品描述</div>
                <div class="item"><input v-model="goods_desc" type="text" class="form-control" name=""/></div>
            </div>

            <div class="sort row-center">
                <div class="index">商品类目</div>
                <div class="item">
                    <div class="select">
                        <form role="form">
                            <div class="form-group">
                                <select class="form-control" v-model="select_category_id">
                                    <option disabled="" value="" selected="selected">请选择商品分类</option>
                                    <option v-for="item in category" v-bind:value="item.id">{{item.name}}
                                    </option>
                                </select>
                            </div>
                        </form>
                    </div>

                    <div class="text">(请务必选对类目)</div>
                </div>
            </div>

            <div class="sort row-center">
                <div class="index">商品排序</div>
                <div class="item"><input v-model="sort" type="text" oninput="value=value.replace(/[^\d]/g,'')"
                                         class="form-control" name=""/></div>
            </div>
        </div>
        <!-- 型号/价格 -->
        <div class="subtitle">
            <div>型号/价格</div>

            <div class="sort row-center">
                <div class="index">价格类型</div>
                <div class="item">
                    是否需要添加参数
                    <label class="form-check-label" v-for="item in priceTypeList">
                        <input class="form-check-input" type="radio" name="pricetype" v-bind:value="item.id"
                               v-model="priceTypeId">
                        {{item.name}}
                    </label>
                </div>
            </div>

            <!--不需要参数-->
            <div class="sort row-center" style="align-items: unset" v-if="priceTypeId == 0">
                <div class="index">商品价格</div>
                <div class="item">
                    <input v-model="goods_price" type="text" class="form-control" name=""
                           oninput="value=value.replace(/[^\d.]/g,'')"/>
                </div>
            </div>
            <div class="sort row-center" style="align-items: unset" v-if="priceTypeId == 0">
                <div class="index">商品库存</div>
                <div class="item">
                    <input v-model="goods_stock" type="text" class="form-control" name=""
                           oninput="value=value.replace(/[^\d]/g,'')"/>
                </div>
            </div>
            <!--需要参数-->
            <div class="sort row-center" style="align-items: unset" v-if="priceTypeId == 1">
                <div class="index">商品型号</div>
                <div class="item">
                    <!--添加商品型号-->
                    <button type="button" class="btn btn-danger" style="margin-left: 0" data-toggle="modal"
                            data-target="#classModal" v-on:click="showClassModal()">自定义型号分类
                    </button>
                    <div class="sort-title1">
                        <!--型号选择标题-->
                        <div v-for="item,index in classSubmitList">
                            <nav class="navbar navbar-default row-center" role="navigation"
                                 style="justify-content: space-between">
                                <div class="select" style="width: 50%">
                                    <form role="form" class="formWidth">
                                        <div class="form-group">
                                            <select class="form-control" :id="'classId'+index"
                                                    v-on:change="selectClass(index)">
                                                <option disabled="" value="" selected="selected">请选择型号分类</option>
                                                <option v-for="classItem,classIndex in classList"
                                                        v-bind:value="classItem">{{classItem}}
                                                </option>
                                            </select>
                                        </div>
                                    </form>
                                    <!--错误提示-->
                                    <div class="alert alert-danger none" :id="'alert'+index"
                                         style="margin-bottom: 0;position: absolute;z-index: 9;transform: translate(-10%,50%)">
                                        <span href="#" class="alert-link">错误！商品型号不能重复。</span>
                                    </div>
                                </div>
                                <div style="width: 50%;text-align: end;cursor: pointer">
                                    <img class="imgDel" src="/images/del.png" v-on:click="delClassItem(index)">
                                </div>
                            </nav>
                            <!--添加型号-->
                            <nav class="navbar navbar-default" role="navigation"
                                 style="background-color: #fff;border: 1px solid #F7F7F7;display: flex;flex-direction: row;flex-wrap:wrap;">
                                <!--展示选择的尺寸-->
                                <div v-for="paramItem,paramIndex in item.param"
                                     style="display: flex;flex-direction: column;align-items: center">
                                    <!--参数-->
                                    <div class="sizeCard">
                                        <span style="width: 80px; display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp: 1;overflow: hidden;text-overflow: ellipsis;">{{paramItem}}</span>
                                        <img src="/images/del.png" v-on:click="delParam(index,paramItem)">
                                    </div>
                                </div>

                                <button v-if="item.select" type="button" class="btn btn-link" style="margin-left: 0"
                                        data-toggle="modal"
                                        data-target="#paramModal" v-on:click="showParamModal(item.select,index)">+添加型号
                                </button>
                            </nav>
                        </div>
                    </div>

                    <!--添加分类-->
                    <nav class="navbar navbar-default row-center" role="navigation">
                        <button type="button" class="btn btn-secondary" v-on:click="createClassList()">添加型号分类</button>
                    </nav>
                </div>
            </div>

            <!--价格和库存-->
            <div class="sort row-center" style="align-items: unset" v-if="classSubmitList.length > 0">
                <div class="index">价格与库存</div>
                <div class="item">
                    <div class="sort-title" style="margin-top: 0">
                        <nav class="navbar navbar-default" role="navigation">
                            <div class="item">
                                <span class="first-title column-center" v-if="classSubmitList.length <= 0"></span>
                                <span class="first-title column-center" v-else
                                      v-for="item in classSubmitList" v-if="item.param.length>0">{{item.select}}</span>
                                <span class="second-title column-center">价格</span>
                                <span class="second-title column-center">库存</span>
                                <!--<span class="second-title column-center">商品编号</span>-->
                            </div>
                        </nav>
                    </div>

                    <div class="sort-title" style="margin-top: 0">
                        <nav class="navbar navbar-default" role="navigation"
                             style="background-color: #fff;border-left: 1px solid #F7F7F7;border-right: 1px solid #F7F7F7;margin-bottom:0;">
                            <div class="item" style="height: auto;border-bottom:1px solid #f3f3f3;"
                                 v-for="item in table">
                                <div class="first-title column-center" v-for="item in JSON.parse(item.param)"
                                     style="border-right: 1px solid #f3f3f3;">
                                    <div style="padding: 10px 0;">{{item}}</div>
                                </div>
                                <div class="second-title row-center" style="width: 16%;justify-content: space-around">
                                    <input class="form-control" v-model="item.price"
                                           oninput="value=value.replace(/[^\d.]/g,'')" style="width: 45%"/>
                                    <input class="form-control" v-model="item.stock"
                                           oninput="value=value.replace(/[^\d]/g,'')" style="width: 45%"/>
                                </div>

                            </div>
                        </nav>
                    </div>

                    <div class="sort-title" style="margin-top: 0">
                        <nav class="navbar navbar-default" role="navigation">
                            <div class="item">
                                <span class="first-title column-center">批量修改价格</span>
                                <span class="second-title column-center">
                                    <input class="form-control" style="width: 90%"/></span>
                                <span class="second-title column-center">
                                    <input class="form-control" oninput="value=value.replace(/[^\d]/g,'')"
                                           style="width: 90%"/></span>
                                <!--<span class="second-title column-center"><input class="form-control" style="width: 90%"/></span>-->
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>


        <div class="subtitle">
            <div class="row-center">
                <button type="button" class="btn btn-secondary" v-on:click="submitGoods(0)">放入仓库</button>
                <button type="button" class="btn btn-danger" v-on:click="submitGoods(1)">上架出售</button>
            </div>
        </div>


        <!--添加类别弹窗-->
        <div class="modal fade" id="classModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="classModalLabel"></h4><!--标题 -->
                    </div>
                    <div class="modal-body"><input type="text" class="form-control" id="classModalText" type="text"
                                                   name=""
                                                   v-model="classModalText"/></div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-primary" v-on:click="addClass()">确定</button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </div>

        <!--添加参数弹窗-->
        <div class="modal fade" id="paramModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="paramModalLabel"></h4><!--标题 -->
                    </div>
                    <div class="modal-body">
                        <div class="row-center" style="display: block">
                            <label class="form-check-label" v-for="item,index in tempParamModal.param">
                                <input type="checkbox" name="sizeCheckbox">
                                <span>{{item}}</span>
                            </label>
                        </div>
                        <div style="margin:8px 0 4px 0">添加型号</div>
                        <input id="paramModalText" type="text" class="form-control" name="" v-model="paramModalText"/>
                        <button type="button" class="btn btn-secondary" style="margin: 4px 0 0 0;width: 200px"
                                v-on:click="createParamToParamList()">添加
                        </button>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-primary" v-on:click="addParam()">确定</button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </div>
    </div>


</div>

<script type="text/javascript" src="../js/menu.js"></script>
<script type="text/javascript" src="../js/addGoods.js"></script>
</body>
</html>